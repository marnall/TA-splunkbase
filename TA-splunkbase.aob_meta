{"basic_builder": {"appname": "TA-splunkbase", "friendly_name": "Splunkbase", "version": "1.0.2", "author": "Marlin A", "description": "This app contains inputs that regularly pull app information from Splunkbase.", "theme": "#708794", "large_icon": "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", "small_icon": "iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAA3BJREFUWEftl99PU2cYxz8lBAchq5DZZVN+GKCzFApO3IqJc7jdyEypi5szlGSblIUrEloyk41TLvQP4ErLzZwumQkXkhnbZBjocFdYgyBjFaqtFIctS9gWyEpHYHnfUSZrbO+0i32Tk5zzPOd9z/f9fr/Pc85RAeuk0VBlAKVQI8NQKrtmGPp/M6RSqUAcz3Bs8dC2bS+gysp6hnAg/QE1Wyy0WVv5+JNPCQaDT52tBIbsdjsOh8Ibbxrx+XzPHyC9vpL29nbcLjfXXK5ED9nsdno2GFpYWKC2tobwozC+u3dZXV3dZEytVqPR7CAW+4tQKMTa2prMiUqtq6tDq61gZOSGzMXjZWVlnDjxIQ8f/kJ/fz/Ly8sJCiRIZrPZ6Olx4Ozro8ViIRAIoNfrWVlZ4ZVXd0pQ47fHKC4uZnp6Gp1ORywWo0L7GouLi/w0eYeioiJ+9vnQ7dlDeYWWSCSCf2YajUaDojgwNZl4fe9edhUVs7S0tAVUIqANhsTO9FXV8mZzUxMXL37N3NwclfoqysvL8fv9Mtd45AiXL3/Ld1evYrG08Mfvv8n4i+rtmw9Surux220ceruBsbExGY+EHzF4/TrNzZYUgDYYMpuPMTQ8vHmzeND6+jrq7QVkZ2fT0dFB95dfkLXRt+Ib8N4cRavV4vffw1hfL9kLzT5ASHzp0jdEo1G5ZkuLRc59aYcmOaB4lRnrDzA1NbUFkLgQgOZCs+Tm5mJqMjM5OcnsgyDhcFjKJjzU53RKr0SjK5SUlhK4f4+8vDy6urpYesw38/PzDA39u2nptce/GEWnjnvo3LnzfH76tASUk5PDrwsRhMmvXBmgrc3Kvrr9zMzMYDAY+PHGiPSJ8Et8OBQFm62Try5c4GWNhsbGRg6/8y5erzdpK3kiICGPrvIfM3uGhygpKaGh4TAfnTzJZ21WRkdHOdVq5QfPMIWFhVKa0t276e3tpbPThrX1FIqicObMWc47nZJV6bn3jkov1huN/BmNMjAw8GTJqqoNmEwmWfYH3zqE23WN/Px8OeH48Q/4fnBQShIM3KegoEDGqw013JkYl+eiCt1uF7U1NfLa4/FgPva+bAmiwm55b0oviSEkFmuOT0wk91Dm5fofR6X/2z4jWTLJ0u4TNmnHekrJzH9ZKqIzDGUYSsVAqnzaeehvQipwAGNKWwQAAAAASUVORK5CYII=", "visible": true, "tab_version": "4.5.1", "tab_build_no": "0", "build_no": 4}, "data_input_builder": {"datainputs": [{"index": "default", "sourcetype": "splunkbase:apps", "interval": "86400", "use_external_validation": true, "streaming_mode_xml": true, "name": "splunkbase_apps", "title": "Splunkbase Apps", "description": "Splunkbase Apps Input - will use the given parameters to index matching apps in Splunkbase", "type": "customized", "parameters": [{"name": "search_query", "label": "Search Query", "help_string": "This is the equivalent of the search bar in the Splunkbase interface. If you are looking for apps with keywords, enter them here. To get all apps, leave this blank.", "required": false, "format_type": "text", "default_value": "", "placeholder": "(optional)", "type": "text", "value": ""}, {"name": "fields", "label": "Fields", "help_string": "App information can be added or removed by including fields in the listing request.", "required": false, "format_type": "text", "default_value": "display_author,icon,categories,support,rating,release", "placeholder": "(optional)", "type": "text", "value": "display_author,icon,categories,support,rating,release"}, {"name": "include_archived_apps", "label": "Archived Apps", "help_string": "Enable this to search for archived apps. If all apps are desired, archived or not, then a second input must be made where this checkbox is set to the opposite setting.", "required": false, "format_type": "checkbox", "default_value": false, "type": "checkbox", "value": false}, {"name": "splunk_products", "label": "Splunk Products", "help_string": "Splunkbase lists apps for Splunk Enterprise and SOAR. The specific product can be filtered for here.", "required": true, "possible_values": [{"value": "splunk", "label": "Splunk Enterprise"}, {"value": "soar", "label": "Splunk SOAR"}, {"value": "all", "label": "All"}], "format_type": "dropdownlist", "default_value": "all", "placeholder": "", "type": "dropdownlist", "value": "all"}, {"name": "results_limit", "label": "Results limit", "help_string": "Limit the number of results. 0 = no limit", "required": false, "format_type": "text", "default_value": "0", "placeholder": "", "type": "text", "value": "20"}, {"name": "custom_source", "label": "Custom Source", "help_string": "A custom source value can be set here. Default source: \"splunkbase_apps\". ", "required": false, "format_type": "text", "default_value": "", "placeholder": "(optional)", "type": "text", "value": ""}, {"name": "custom_sourcetype", "label": "Custom Sourcetype", "help_string": "A custom sourcetype can be set here. Defaults to \"splunkbase:apps\"", "required": false, "format_type": "text", "default_value": "", "placeholder": "(optional)", "type": "text", "value": ""}], "data_inputs_options": [{"type": "customized_var", "name": "search_query", "title": "Search Query", "description": "This is the equivalent of the search bar in the Splunkbase interface. If you are looking for apps with keywords, enter them here. To get all apps, leave this blank.", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "", "placeholder": "(optional)"}, {"type": "customized_var", "name": "fields", "title": "Fields", "description": "App information can be added or removed by including fields in the listing request.", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "display_author,icon,categories,support,rating,release", "placeholder": "(optional)"}, {"type": "customized_var", "name": "include_archived_apps", "title": "Archived Apps", "description": "Enable this to search for archived apps. If all apps are desired, archived or not, then a second input must be made where this checkbox is set to the opposite setting.", "required_on_edit": false, "required_on_create": false, "format_type": "checkbox", "default_value": false}, {"type": "customized_var", "name": "splunk_products", "title": "Splunk Products", "description": "Splunkbase lists apps for Splunk Enterprise and SOAR. The specific product can be filtered for here.", "required_on_edit": false, "required_on_create": true, "possible_values": [{"value": "splunk", "label": "Splunk Enterprise"}, {"value": "soar", "label": "Splunk SOAR"}, {"value": "all", "label": "All"}], "format_type": "dropdownlist", "default_value": "all", "placeholder": ""}, {"type": "customized_var", "name": "results_limit", "title": "Results limit", "description": "Limit the number of results. 0 = no limit", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "0", "placeholder": ""}, {"type": "customized_var", "name": "custom_source", "title": "Custom Source", "description": "A custom source value can be set here. Default source: \"splunkbase_apps\". ", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "", "placeholder": "(optional)"}, {"type": "customized_var", "name": "custom_sourcetype", "title": "Custom Sourcetype", "description": "A custom sourcetype can be set here. Defaults to \"splunkbase:apps\"", "required_on_edit": false, "required_on_create": false, "format_type": "text", "default_value": "", "placeholder": "(optional)"}], "code": "# encoding = utf-8\nimport os\nimport sys\nimport time\nimport datetime\nimport json\nfrom math import ceil\n\ndef validate_input(helper, definition):\n    \"\"\"Implement your own validation logic to validate the input stanza configurations\"\"\"\n    # This example accesses the modular input variable\n    # filters = definition.parameters.get('filters', None)\npass\n\ndef collect_events(helper, ew):\n\n    # Parameters\n    query = helper.get_arg('search_query')\n    includes = helper.get_arg('fields')\n    archive = str(helper.get_arg('include_archived_apps')).lower()\n    product = helper.get_arg('splunk_products')\n    results_limit = helper.get_arg('results_limit')\n    custom_source = helper.get_arg('custom_source')\n    custom_sourcetype = helper.get_arg('custom_sourcetype')\n    \n    # Set default source and sourcetype if not set in inputs\n    evt_source = \"\"\n    if custom_source != \"\" and custom_source != None:\n        evt_source = custom_source\n    else:\n        evt_source = \"splunkbase_apps\"\n    \n    evt_sourcetype = \"\"\n    if custom_sourcetype != \"\" and custom_sourcetype != None:\n        evt_sourcetype = custom_sourcetype\n    else:\n        evt_sourcetype = \"splunkbase:apps\"\n    \n    # static vars\n    base_url = \"https://api.splunkbase.splunk.com\"\n    api_path = \"/api/v2/apps\"\n    includes_string = \"?include=\"+str(includes)\n    # The API seems to max out around 60 per page by default so lets just set this to 50.\n    apps_per_page = 50 \n    \n    # if limit is less than 50, reduce apps per page\n    if results_limit and int(results_limit) < 50 and int(results_limit) > 0:\n        apps_per_page = int(results_limit)\n    limit_string = \"&limit=\"+str(apps_per_page) \n    product_string = \"&product=\"+str(product)\n    if archive == \"true\" or archive == 1 or archive == True:\n        archive = \"true\"\n    else:\n        archive = \"false\"\n    \n    archive_string = \"&archive=\"+str(archive)\n    \n    # Handle query\n    if query != \"\" and query != None:\n        query_string = \"&query=\"+str(query)\n    else:\n        query_string = \"\"\n    remaining_string = \"&order=latest&offset=\"\n    \n    \n    # FIRST PAGE REQUEST\n    url = base_url + api_path + includes_string + limit_string + product_string + archive_string + query_string + remaining_string + \"0\"\n    response = helper.send_http_request(url, method=\"GET\", parameters=None, payload=None,\n                                        headers=None, cookies=None, verify=True, cert=None,\n                                        timeout=None, use_proxy=True)\n    r_json = response.json()\n    \n    for app in r_json[\"results\"]:\n            event = helper.new_event(time=None,source=evt_source, index=helper.get_output_index(), sourcetype=evt_sourcetype, data=json.dumps(app, sort_keys=True,ensure_ascii=False))\n            ew.write_event(event)\n    # FINISH FIRST PAGE REQUEST\n    \n    # if results_limit less than 50, then terminate here.\n    if results_limit and int(results_limit) < 50 and int(results_limit) > 0:\n        return\n    \n    # Get number of remaining pages\n    total_apps_found = r_json[\"total\"]\n    if results_limit and int(results_limit) >= 50 and int(results_limit) < total_apps_found:\n        total_apps_found = int(results_limit)\n\n    total_pages_found = ceil(total_apps_found/apps_per_page)\n    \n    # ALL OTHER REQUEST PAGES WITH OFFSET:\n    for i in range(1,total_pages_found):\n        \n        # No need to request all 50 entries on the last page. Change the limit for last call\n        if (int(results_limit) % int(apps_per_page)) != 0 and (i == total_pages_found-1):\n                limit_string = \"&limit=\"+str(int(results_limit) % int(apps_per_page)) \n        \n        url2 = base_url + api_path + includes_string + limit_string + product_string + archive_string + query_string + remaining_string + str(i*apps_per_page)\n        response2 = helper.send_http_request(url2, method=\"GET\", parameters=None, payload=None,\n                                        headers=None, cookies=None, verify=True, cert=None,\n                                        timeout=None, use_proxy=True)\n        r_json2 = response2.json()\n        for app2 in r_json2[\"results\"]:\n            event = helper.new_event(time=None,source=evt_source, index=helper.get_output_index(), sourcetype=evt_sourcetype, data=json.dumps(app2, sort_keys=True,ensure_ascii=False))\n            ew.write_event(event)\n    \n    \n", "customized_options": [{"name": "search_query", "value": ""}, {"name": "fields", "value": "display_author,icon,categories,support,rating,release"}, {"name": "include_archived_apps", "value": false}, {"name": "splunk_products", "value": "all"}, {"name": "results_limit", "value": "1"}, {"name": "custom_source", "value": ""}, {"name": "custom_sourcetype", "value": ""}], "uuid": "abe44ac2e5c24a82a52f5201d3b2c0f5", "sample_count": 0}]}, "global_settings_builder": {"global_settings": {"proxy_settings": {"proxy_type": "http", "proxy_enabled": false, "proxy_url": "", "proxy_port": "", "proxy_username": ""}, "log_settings": {"log_level": "DEBUG"}}}, "sourcetype_builder": {"splunkbase:apps": {"metadata": {"event_count": 0, "data_input_name": "splunkbase_apps", "extractions_count": 0, "cims_count": 0}}}, "validation": {"validators": ["best_practice_validation", "data_model_mapping_validation", "field_extract_validation", "app_cert_validation"], "status": "job_finished", "validation_id": "v_1763787917_81", "progress": 1.0}}